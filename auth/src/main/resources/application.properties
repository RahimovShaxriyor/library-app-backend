# Basic settings
server.port=8082
spring.application.name=auth-service

# Database
spring.datasource.url=jdbc:oracle:thin:@localhost:1521/FREEPDB1
spring.datasource.username=system
spring.datasource.password=StrongPassword123
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver

# ===================================================================
# JPA - ??????? ????????? ?????
# ===================================================================
spring.jpa.database-platform=org.hibernate.dialect.OracleDialect

# 'create-drop': Hibernate ?????? ??? ??????? ??? ????????? ??????????
# ? ??????? ?? ?????? ??? ????????? ???????.
# ???????? ??? ??????????, ????? ????????????? ?????? ???? ??????.
spring.jpa.hibernate.ddl-auto=create-drop

spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
# ===================================================================

# Redis
spring.cache.type=redis
spring.data.redis.host=localhost
spring.data.redis.port=6379

# JWT
jwt.secret=bUeXaiV7t25agVd244f/sL1bVfH8a9hKkP2fN6qW8yR3gC7jE0lO+oZ5cN4mX6rD/pI9sT1vY2uW3xZ/qA==
jwt.access-token-expiration-ms=900000
jwt.refresh-token-expiration-ms=604800000

# Bucket4j Rate Limiting
bucket4j.enabled=true

# --- ??????? #1: ??????????? ??? ????????? ????? ---
bucket4j.filters[0].cache-name=buckets
bucket4j.filters[0].url=/api/auth/login
bucket4j.filters[0].rate-limits[0].bandwidths[0].capacity=10
bucket4j.filters[0].rate-limits[0].bandwidths[0].time=1
bucket4j.filters[0].rate-limits[0].bandwidths[0].unit=minutes
bucket4j.filters[0].http-response-body={ "message": "?? ????????? ????? ???????? ?? ????.", "status": 429 }

# --- ??????? #2: ??????? ??????????? ??? ?????? ?????? ---
bucket4j.filters[1].cache-name=buckets
bucket4j.filters[1].url=/api/auth/forgot-password
bucket4j.filters[1].rate-limits[0].bandwidths[0].capacity=5
bucket4j.filters[1].rate-limits[0].bandwidths[0].time=10
bucket4j.filters[1].rate-limits[0].bandwidths[0].unit=minutes
bucket4j.filters[1].http-response-body={ "message": "?? ????????? ????? ???????? ?? ????? ??????.", "status": 429 }

# --- ??????? #3: ??????????? ??? ??????????? ---
bucket4j.filters[2].cache-name=buckets
bucket4j.filters[2].url=/api/auth/register
bucket4j.filters[2].rate-limits[0].bandwidths[0].capacity=20
bucket4j.filters[2].rate-limits[0].bandwidths[0].time=1
bucket4j.filters[2].rate-limits[0].bandwidths[0].unit=hours
bucket4j.filters[2].http-response-body={ "message": "?? ????????? ????? ???????? ?? ???????????.", "status": 429 }

# Actuator
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always

